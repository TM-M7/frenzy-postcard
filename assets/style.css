/* Night (default) */
:root{
  --fg:#ffffff;           /* базовый текст: белый */
  --fg-dim:#e0e0ff;       /* второстепенный текст: светлый серо-голубой */
  --link-accent:#ffb14a;  /* accent: campfire orange */  /* акцент: жёлтый */
  --link-accent-2:#42d6d1;/* accent: starlight teal *//* акцент: бирюзовый */
  --glass: rgba(18, 22, 40, 0.55);
  --glass-border: rgba(255,255,255,0.10);
}

body.theme-day{
  --fg:#101420;           /* чёрный для дня */
  --fg-dim:#3c465a;       /* тёмно-серый для дня */
  --link-accent:#ff9f3a;  /* accent: campfire orange */
  --link-accent-2:#2fb8ff;/* accent: starlight teal */
  --glass: rgba(255,255,255,0.65);
  --glass-border: rgba(0,0,0,0.06);
}

.text-dim{ color: var(--fg-dim) !important; }

body.theme-night,
body.theme-night .accordion-button,
body.theme-night .list-group-item,
body.theme-night .table td,
body.theme-night .table th {
  color: #fdfdfd !important;
}

body.theme-night .text-dim,
body.theme-night small,
body.theme-night .small {
  color: #d5d9ff !important;
}


html,body{height:100%}
html{scroll-behavior:smooth}
body{
  font-family: Inter, system-ui, Segoe UI, Roboto, Arial, sans-serif;
  color: var(--fg);
  overflow-x:hidden;
}



/* Static backgrounds (CSS lives in /assets → paths are relative) */
body::before{
  content:"";
  position:fixed; inset:0;
  background:url("img/characters.png") no-repeat center center fixed;
  background-size:cover;
  z-index:-2;
}
body.theme-day::before{
  background:url("img/day-bg.jpg") no-repeat center center fixed;
  background-size:cover;
}

h2 {
  position: relative;
  display: inline-block;
  padding-bottom: .3rem;
}
h2::after {
  content: "";
  position: absolute; left: 0; right: 0; bottom: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--link-accent), var(--link-accent-2));
  border-radius: 99px;
}
.price {
  color: var(--link-accent) !important;
  text-shadow: 0 0 6px rgba(255,177,74,.6);
}


/* Canvas layer for leaves */
#bgCanvas{
  position:fixed; inset:0; width:100vw; height:100vh;
  z-index:-1; display:block; pointer-events:none;
}

/* Glass look */
.glass {
  backdrop-filter: blur(14px) saturate(130%);
  background: rgba(15, 15, 25, 0.6) !important;
  border: 1px solid rgba(255,255,255,0.15) !important;
  box-shadow: 0 8px 30px rgba(0,0,0,.45) !important;
}
body.theme-day .glass {
  background: rgba(255,255,255,0.75) !important;
}


/* Headline style */
h1,h2,h3{ font-family:"Playfair Display", serif; letter-spacing:.2px; }
.headline span{
  box-shadow: inset 0 -0.35em 0 0 color-mix(in oklab, var(--link-accent) 22%, transparent);
}
a.link{ position:relative; color:inherit; text-decoration:none; }
a.link:hover {
  color: var(--link-accent) !important;
  text-shadow: 0 0 6px rgba(255,177,74,.6);
}

a.link::after{
  content:""; position:absolute; left:0; right:0; bottom:-3px; height:2px;
  background:linear-gradient(90deg,var(--link-accent),var(--link-accent-2));
  opacity:0; transform:translateY(4px); transition:.25s; border-radius:999px;
}
a.link:hover::after{ opacity:1; transform:none; }


/* Smartphone-like gallery */
.gallery-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(120px,1fr));
  gap:10px;
}
@media (min-width:768px){ .gallery-grid{ grid-template-columns:repeat(auto-fill,minmax(140px,1fr)); gap:12px; } }
@media (min-width:1024px){ .gallery-grid{ grid-template-columns:repeat(auto-fill,minmax(160px,1fr)); gap:14px; } }

.tile{
  position:relative; border-radius:16px; overflow:hidden;
  backdrop-filter: blur(6px) saturate(120%);
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.12);
  box-shadow: 0 10px 30px rgba(0,0,0,.25);
  transition: transform .18s ease, box-shadow .18s ease, background .18s ease;
}
body.theme-day .tile{
  background: rgba(255,255,255,.55);
  border-color: rgba(0,0,0,.08);
  box-shadow: 0 10px 24px rgba(0,0,0,.15);
}
.tile:hover{ transform: translateY(-2px); box-shadow: 0 16px 44px rgba(0,0,0,.36); }
.tile img{ display:block; width:100%; height:100%; object-fit:cover; filter: saturate(1.03); }
.tile::after{ content:""; position:absolute; inset:0; pointer-events:none;
  background: linear-gradient(to bottom, rgba(0,0,0,0), rgba(0,0,0,.12));
}

/* Latest from TG */
.latest-wrap{ margin-top:14px; }
.latest-card{
  position:relative; border-radius:18px; overflow:hidden;
  backdrop-filter: blur(6px) saturate(120%);
  background: rgba(255,255,255,.07);
  border: 1px solid rgba(255,255,255,.14);
  box-shadow: 0 12px 40px rgba(0,0,0,.3);
}
body.theme-day .latest-card{ background: rgba(255,255,255,.6); border-color: rgba(0,0,0,.08); }
.latest-card img{ width:100%; height:260px; object-fit:cover; display:block; }
.latest-label{
  position:absolute; bottom:10px; right:12px; font-weight:600; font-size:12px;
  padding:.35rem .6rem; border-radius:999px; background:rgba(0,0,0,.55); color:#fff;
}

/* Transparent table inside glass */
.table{
  --bs-table-bg: transparent;
  --bs-table-border-color: rgba(255,255,255,.12);
  color: var(--fg);
}
.table thead tr{ background: rgba(255,255,255,.05); }
.table tbody tr{ border-top: 1px solid rgba(255,255,255,.12); }
body.theme-day .table thead tr{ background: rgba(0,0,0,.04); }
body.theme-day .table tbody tr{ border-top: 1px solid rgba(0,0,0,.08); }

/* Light-ish util */
.btn-light-subtle{ background:#ffffff20; color:var(--fg); border-color:#ffffff33; }
.btn-light-subtle:hover{ background:#ffffff30; }

/* ——— Process / Prompt-book: стеклянный аккордеон и читабельность ——— */
.accordion.glass{
  background: var(--glass) !important;
  border: 1px solid var(--glass-border) !important;
  box-shadow: 0 8px 30px rgba(0,0,0,.45);
}
.accordion.glass .accordion-item{
  background: transparent;
  border: none;
}
.accordion.glass .accordion-button{
  background: linear-gradient(0deg, rgba(255,255,255,.05), rgba(255,255,255,.08));
  color: var(--fg);
  box-shadow: none;
}
body.theme-day .accordion.glass .accordion-button{
  background: linear-gradient(0deg, rgba(0,0,0,.03), rgba(0,0,0,.06));
}
.accordion.glass .accordion-button.collapsed{
  background: transparent;
  color: var(--fg);
}
.accordion.glass .accordion-button:focus{
  box-shadow: 0 0 0 .2rem rgba(255,177,74,.25);
  border-color: color-mix(in oklab, var(--link-accent) 40%, transparent);
}
.accordion.glass .accordion-body{
  background: rgba(0,0,0,.08);
  color: var(--fg);
}

/* Чёткие цвета текста ночью — только светлые */
body.theme-night,
body.theme-night .accordion-button,
body.theme-night .list-group-item,
body.theme-night .accordion-body,
body.theme-night .table td,
body.theme-night .table th{
  color: #fdfdfd !important;
}
body.theme-night .text-dim,
body.theme-night small,
body.theme-night .small{
  color: #d5d9ff !important;
}

/* Подчеркивающая линия заголовкам раздела */
#process > h2{
  position:relative; display:inline-block; padding-bottom:.3rem;
}
#process > h2::after{
  content:""; position:absolute; left:0; right:0; bottom:0; height:3px;
  background: linear-gradient(90deg, var(--link-accent), var(--link-accent-2));
  border-radius:999px; opacity:.9;
}

/* inputs в ночной теме — контрастные */
body.theme-night .form-control{
  background: rgba(255,255,255,.06);
  color: #fff;
  border: 1px solid rgba(255,255,255,.14);
}
body.theme-night .form-control:focus{
  border-color: rgba(255,177,74,.6);
  box-shadow: 0 0 0 .2rem rgba(255,177,74,.25);
}

#ambientControl {
  backdrop-filter: blur(10px) saturate(120%);
  background: rgba(20,20,30,0.6);
  border: 1px solid rgba(255,255,255,.15);
  box-shadow: 0 6px 20px rgba(0,0,0,.4);
}
body.theme-day #ambientControl {
  background: rgba(255,255,255,0.75);
  border-color: rgba(0,0,0,.1);
}

/* Подсказка у плеера */
#ambHint{
  position:fixed; z-index:1200;
  max-width:260px;
  padding:14px 16px 12px;
  border-radius:14px;
  background: rgba(20,20,30,0.85);
  border:1px solid rgba(255,255,255,.18);
  box-shadow: 0 8px 30px rgba(0,0,0,.55);
  color:#fff;
  backdrop-filter: blur(10px) saturate(120%);
  animation: fadeIn .25s ease;
}
#ambHint .arrow{
  position:absolute;
  top:-18px;               /* подгоняй позицию сюда */
  right:56px;              /* и сюда — чтобы указывало ровно на контролы */
  width:0; height:0;
  border-left:12px solid transparent;
  border-right:12px solid transparent;
  border-bottom:20px solid var(--link-accent); /* ярко-жёлтый */
  filter: drop-shadow(0 0 6px var(--link-accent)) drop-shadow(0 0 14px #ff8f2a);
  animation: glowArrow 1.2s infinite alternate;
}
#ambHint .btn-ok{
  margin-top:10px;
  padding:.3rem .8rem;
  border-radius:999px;
  border:1px solid var(--link-accent);
  color:var(--link-accent);
  background:transparent;
}
#ambHint .btn-ok:hover{ background:rgba(255,210,0,.12); }

@keyframes glowArrow{
  from { filter: drop-shadow(0 0 6px var(--link-accent)) drop-shadow(0 0 14px #ff8f2a); }
  to   { filter: drop-shadow(0 0 12px #ffd37a) drop-shadow(0 0 22px var(--link-accent)); }
}
@keyframes fadeIn{ from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:none} }

/* === NAV & PLAYER Z-ORDER / MOBILE === */
.navbar { z-index: 1300; }          /* меню поверх всего */
#ambientControl { z-index: 900; }   /* плеер ниже меню */

@media (max-width: 576px){
  /* чтобы плеер не перекрывал хедер на телефонах */
  #ambientControl{
    top: auto; bottom: 14px; right: 14px;
  }
}

/* === Жёлтый гамбургер и рамка === */
.navbar-toggler{
  border-color: var(--link-accent) !important;
  box-shadow: 0 0 10px rgba(255,177,74,.25);
}
.navbar-toggler:focus{ box-shadow: 0 0 0 .2rem rgba(255,177,74,.25); }

/* кастомная иконка гамбургера с жёлтыми линиями */
.navbar-toggler-icon{
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3E%3Cpath stroke='%23ffb14a' stroke-width='2' stroke-linecap='round' d='M4 7h22M4 15h22M4 23h22'/%3E%3/svg%3E") !important;
  filter: drop-shadow(0 0 6px rgba(255,177,74,.6));
}

/* опционально — цвет выпавшего меню “под сайт” */
.navbar .collapse{
  background: rgba(20,20,30,.50);
  border-radius: 12px;
  padding: .4rem .6rem;
}
body.theme-day .navbar .collapse{
  background: rgba(255, 211, 138, .25); /* тёплый жёлтый в дневной теме */
}

/* мини-кнопка-квадратик (меню галереи) */
.btn-square {
  width: 38px; height: 34px; display: inline-flex; align-items: center; justify-content: center;
  border-radius: 10px; border: 1px solid rgba(255,255,255,.2);
  background: linear-gradient(180deg, rgba(255,177,74,.25), rgba(255,177,74,.08));
}
.btn-square i{
  font-style: normal; font-weight: 800; line-height: 1;
}

/* === "БОЛЬШЕ?" оверлей на последней карточке галереи === */
.gallery-grid { position: relative; } /* контейнер с превью */
.gallery-item { position: relative; overflow: hidden; }

.gallery-item.more-overlay::after,
.gallery-item.more-overlay::before {
  content: "";
  position: absolute; inset: 0;
  pointer-events: none;
  transition: .25s ease;
}

/* затемнение + лёгкий блюр у картинки, когда наведён оверлей */
.gallery-item.more-overlay:hover img,
.gallery-item.more-overlay:focus-within img {
  filter: blur(2px) brightness(.65);
  transform: scale(1.02);
}

/* лёгкий общий градиент-дымка поверх */
.gallery-item.more-overlay::before {
  background: radial-gradient(120% 120% at 100% 0%,
              rgba(255,177,74,.20), rgba(0,0,0,.55));
  opacity: .0;
}
.gallery-item.more-overlay:hover::before,
.gallery-item.more-overlay:focus-within::before { opacity: 1; }

/* центр: 3 светящиеся полоски */
.more-btn {
  position: absolute; inset: 0;
  display: grid; place-items: center;
  z-index: 2;
}
.more-bars {
  display: grid; gap: 6px;
  filter: drop-shadow(0 0 10px rgba(255,177,74,.9))
          drop-shadow(0 0 18px rgba(255,177,74,.5));
  transform: translateY(0);
  transition: transform .25s ease, opacity .25s ease;
}
.more-bars span{
  width: 56px; height: 5px; border-radius: 6px;
  background: linear-gradient(90deg,#c27a06,#ff5e00 70%, #c59241);
  opacity: .95;
}

/* подпись "БОЛЬШЕ?" всплывает на ховере */
.more-caption {
  position: absolute; bottom: 14px; right: 14px;
  font-weight: 800; letter-spacing: .5px;
  background: rgba(20,20,30,.55);
  border: 1px solid rgba(255,177,74,.6);
  border-radius: 999px; padding: 6px 12px;
  color: #c76b01; text-transform: uppercase; font-size: 12px;
  backdrop-filter: blur(6px);
  opacity: 0; transform: translateY(6px);
  transition: .25s ease;
}

/* наведение/фокус */
.gallery-item.more-overlay:hover .more-bars,
.gallery-item.more-overlay:focus-within .more-bars { transform: translateY(-2px); }
.gallery-item.more-overlay:hover .more-caption,
.gallery-item.more-overlay:focus-within .more-caption { opacity: 1; transform: translateY(0); }

/* доступность фокуса для клавы */
.more-link{ position:absolute; inset:0; z-index:3; }
.more-link:focus{ outline: none; }
.more-link:focus-visible{ outline: 2px solid var(--link-accent); outline-offset: 4px; border-radius: 12px; }

/* плеер не перекрывает модалку */
.lb-open #ambientControl { 
  pointer-events: none; 
  opacity: .25;
  filter: blur(1px);
}

#lb-close{
  position:absolute; right:18px; top:12px;
  z-index: 2105;                 /* выше всех */
  pointer-events: auto;          /* на всякий случай */
  padding: 6px 10px;
  line-height: 1;
  border-radius: 10px;
  background: rgba(20,20,30,.35);
  border: 1px solid rgba(255,177,74,.55);
}
#lb-close:focus-visible{
  outline: 2px solid var(--link-accent); outline-offset: 3px;
}
/* --- HARD FIX: player size & layers --- */
:root { --ac: var(--link-accent); }

#ambientControl{
  position: fixed !important;
  top: 12px !important; right: 12px !important; left: auto !important; bottom: auto !important;
  display: inline-flex !important;
  align-items: center !important;
  gap: 10px !important;
  padding: 10px 12px !important;
  width: auto !important;
  max-width: min(420px, calc(100vw - 24px)) !important;

  /* главная проблема – высота; принудительно «сжимаем» */
  height: auto !important;
  max-height: 64px !important;

  overflow: hidden !important;
  isolation: isolate !important;
  contain: layout paint !important;

  z-index: 900 !important;
  background: rgba(18,18,26,.6) !important;
  -webkit-backdrop-filter: blur(10px) !important;
  backdrop-filter: blur(10px) !important;
  border: 1px solid rgba(255,177,74,.35) !important;
  border-radius: 16px !important;
  box-shadow: 0 8px 24px rgba(0,0,0,.35) !important;
}
/* если внутри кто-то растягивает блок псевдоэлементами — вырубаем */
#ambientControl::before,
#ambientControl::after{ display:none !important; }

/* иногда внутренности делают высоту 100% / абсолюты — обнуляем */
#ambientControl *{
  position: static !important;
  max-height: 48px !important;
  box-sizing: border-box !important;
}

/* значок/кнопка в правом верхнем углу — всегда поверх плеера */
.navbar, .navbar * { position: relative; z-index: 1300 !important; }
.btn-square, .navbar .navbar-toggler{
  z-index: 1310 !important;
  pointer-events: auto !important;
  mix-blend-mode: normal !important;
  filter: drop-shadow(0 0 6px rgba(255,177,74,.6));
}

/* когда открыт лайтбокс/модалка — плеер не мешает */
.lb-open #ambientControl,
.modal-open #ambientControl{
  pointer-events: none !important;
  opacity: .25 !important;
  filter: blur(1px) !important;
}

/* мобильная позиция плеера — вниз-вправо */
@media (max-width: 576px){
  #ambientControl{
    top: auto !important; bottom: 12px !important; right: 12px !important;
    max-width: min(94vw, 420px) !important;
  }
}
